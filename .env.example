# MailGoat + Postal Full Stack Configuration
# Copy this file to .env and configure with your actual values
#
# Quick Start:
#   cp .env.example .env
#   nano .env  # Edit with your values
#   docker-compose -f docker-compose.full.yml up -d

# ======================
# DOMAIN CONFIGURATION
# ======================

# Your primary domain (for the Postal web interface)
POSTAL_HOSTNAME=postal.example.com
POSTAL_PROTOCOL=https

# Your SMTP hostname (for sending/receiving mail)
# This should be a subdomain like mail.example.com
SMTP_HOSTNAME=mail.example.com

# ======================
# DATABASE PASSWORDS
# ======================

# MariaDB root password (keep this secure!)
DB_ROOT_PASSWORD=CHANGE_THIS_TO_A_SECURE_PASSWORD

# MariaDB postal user password
DB_PASSWORD=CHANGE_THIS_TO_A_SECURE_PASSWORD

# ======================
# RABBITMQ CONFIGURATION
# ======================

RABBITMQ_USER=postal
RABBITMQ_PASSWORD=CHANGE_THIS_TO_A_SECURE_PASSWORD

# ======================
# POSTAL SECURITY KEYS
# ======================

# Generate these with: openssl rand -hex 64
# These MUST be unique and kept secret!
SECRET_KEY_BASE=GENERATE_A_LONG_RANDOM_STRING_WITH_OPENSSL_RAND_HEX_64
SIGNING_KEY=GENERATE_ANOTHER_LONG_RANDOM_STRING_WITH_OPENSSL_RAND_HEX_64

# ======================
# MAILGOAT CONFIGURATION
# ======================

# MailGoat API key (generated from Postal web UI after setup)
# Leave empty for initial setup, then add after creating credentials in Postal
MAILGOAT_API_KEY=

# Default from address for MailGoat CLI
MAILGOAT_FROM_EMAIL=noreply@example.com

# ======================
# PORT CONFIGURATION
# ======================

# Postal web UI port (default: 5000)
POSTAL_WEB_PORT=5000

# SMTP ports
SMTP_PORT=25        # Standard SMTP (requires root or port forwarding)
SMTP_SUBMISSION_PORT=587  # SMTP submission (authenticated)

# ======================
# POSTAL FEATURES
# ======================

# Enable IP pools (for advanced routing)
USE_IP_POOLS=false

# Enable SMTP TLS
SMTP_TLS_ENABLED=false

# TLS certificate paths (if SMTP_TLS_ENABLED=true)
TLS_CERT_PATH=/path/to/cert.pem
TLS_KEY_PATH=/path/to/key.pem

# ======================
# WORKER CONFIGURATION
# ======================

# Number of worker replicas (default: 2)
WORKER_REPLICAS=2

# Processes per worker (default: 4)
WORKER_PROCESSES=4

# Threads per process (default: 5)
WORKER_THREADS=5

# ======================
# PRODUCTION NOTES
# ======================

# 1. Generate secure passwords:
#    openssl rand -base64 32
#
# 2. Generate secret keys:
#    openssl rand -hex 64
#
# 3. DNS Configuration Required:
#    - A record: postal.example.com → your-server-ip
#    - A record: mail.example.com → your-server-ip
#    - MX record: example.com → mail.example.com (priority 10)
#    - TXT record: example.com → "v=spf1 mx ~all"
#    - DKIM/DMARC records (configured after Postal setup)
#
# 4. Port 25 Requirements:
#    - Most VPS providers block port 25 by default
#    - Request unblocking from your provider (AWS, DigitalOcean, etc.)
#    - Alternative: Use port 587 for submission only
#
# 5. SSL/TLS:
#    - Use Let's Encrypt with certbot for automatic certificates
#    - Or place certificates in /path/to/cert.pem
#
# 6. Firewall:
#    - Open ports: 25, 80, 443, 587
#    - Close ports: 3306, 5432, 5672, 6379, 15672
#
# 7. Backup Strategy:
#    - Uncomment db-backup service in docker-compose.full.yml
#    - Backup volumes: mariadb-data, redis-data, rabbitmq-data
#
# 8. Monitoring:
#    - RabbitMQ UI: http://your-server:15672
#    - Postal Web UI: https://postal.example.com:5000
